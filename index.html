<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Controle de Gastos — Excel Model</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <header class="title">
    <h1>Controle de Gastos</h1>
    <p class="muted">Visão mensal de saldo, crédito global, VR e investimentos</p>
  </header>

  <div class="month-incrementer">
    <button id="prev-month" class="pill-btn">&lt;</button>
    <div class="month-display">
      <span class="month-caption">Índice do mês</span>
      <span id="month-index" class="month-index">0</span>
      <span id="month-label" class="month-label"></span>
    </div>
    <button id="next-month" class="pill-btn">&gt;</button>
  </div>

  <nav class="tabs">
    <button data-tab="dashboard" class="tab-btn active">Dashboard</button>
    <button data-tab="input" class="tab-btn">Input</button>
    <button data-tab="inicio" class="tab-btn">Início do mês</button>
    <button data-tab="invest" class="tab-btn">Investimentos</button>
    <button data-tab="log" class="tab-btn">Log</button>
  </nav>

  <main class="wrap">
    <!-- DASHBOARD -->
    <section id="tab-dashboard" class="tab-panel active panel">
      <div class="panel-section">
        <h2 class="panel-title">Contas e resumo</h2>
        <div class="panel-grid">
          <div class="panel-card panel-card-full">
            <table class="accounts-table">
              <thead>
                <tr>
                  <th>Conta</th>
                  <th>Saldo</th>
                  <th>Gasto crédito (mês)</th>
                  <th>Gasto VR (mês)</th>
                  <th>Guardado</th>
                </tr>
              </thead>
              <tbody id="accounts-body"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="panel-section">
        <div class="panel-grid">
          <div class="panel-card">
            <h3 class="card-title">Crédito por conta (mês)</h3>
            <div class="chart-wrapper">
              <canvas id="gasto-credito-chart"></canvas>
            </div>

            <div class="card-header-inline">
              <h3 class="card-title">Entradas por conta (mês)</h3>
              <label class="inline-toggle">
                <input id="include-start-entrada" type="checkbox" checked/>
                incluir entrada inicial
              </label>
            </div>
            <div class="chart-wrapper">
              <canvas id="entrada-pie-chart"></canvas>
            </div>

            <h3 class="card-title">Gasto por categoria (mês)</h3>
            <div class="chart-wrapper">
              <canvas id="category-pie-chart"></canvas>
            </div>
          </div>

          <div class="panel-card">
            <h3 class="card-title">Visão geral do mês</h3>
            <div class="yellow-grid">
              <div class="y-row"><span>Crédito (soma disponível)</span><strong id="avail-credit">R$ 0,00</strong></div>
              <div class="y-row"><span>VR (disponível)</span><strong id="avail-vr">R$ 0,00</strong></div>
              <div class="y-row"><span>Saldo</span><strong id="avail-saldo">R$ 0,00</strong></div>
              <div class="y-row"><span>Guardado</span><strong id="avail-guardado">R$ 0,00</strong></div>
            </div>

            <div class="small-box">
              <span>Crédito + débito</span>
              <strong id="credit-debit-small">R$ 0,00</strong>
            </div>

            <h3 class="card-title" style="margin-top:14px">Tendência de gastos (6 meses)</h3>
            <div class="chart-wrapper chart-wrapper-sm">
              <canvas id="monthly-line-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- INPUT -->
    <section id="tab-input" class="tab-panel inputs">
      <h2 class="panel-title">Novo lançamento</h2>

      <form id="expense-form" class="form-grid">
        <div class="form-field">
          <label>Data</label>
          <input type="date" id="exp-date" />
        </div>
        <div class="form-field">
          <label>Descrição</label>
          <input type="text" id="exp-desc" placeholder="Ex: mercado, gasolina..."/>
        </div>
        <div class="form-field">
          <label>Valor (R$)</label>
          <input type="number" step="0.01" id="exp-amount" required/>
        </div>
        <div class="form-field">
          <label>Tipo</label>
          <select id="exp-type">
            <option value="saldo">Débito no saldo</option>
            <option value="credito">Gasto no crédito</option>
            <option value="vr">Gasto no VR (Caju)</option>
            <option value="entrada">Entrada</option>
          </select>
        </div>
        <div class="form-field">
          <label>Banco / conta</label>
          <select id="exp-account"></select>
        </div>
        <div class="form-field">
          <label>Categoria</label>
          <select id="exp-category">
            <option value="alimentacao">Alimentação</option>
            <option value="gasolina">Gasolina</option>
            <option value="mercado">Mercado</option>
            <option value="transporte">Transporte</option>
            <option value="lazer">Lazer</option>
            <option value="saude">Saúde</option>
            <option value="assinaturas">Assinaturas</option>
            <option value="investimento">Investimento</option>
            <option value="outros">Outros</option>
          </select>
        </div>
        <div class="form-field">
          <label>Forma</label>
          <input type="text" id="exp-method" placeholder="Cartão, dinheiro..."/>
        </div>
        <div class="form-actions">
          <button class="btn-primary" type="submit">Registrar</button>
        </div>
      </form>

      <hr class="divider"/>

      <h3 class="panel-subtitle">Linhas longas (edição manual)</h3>
      <div id="editable-accounts" class="editable-accounts"></div>

      <div class="actions">
        <button id="save-btn" class="btn">Salvar</button>
        <button id="reset-btn" class="btn danger">Zerar tudo</button>
      </div>
    </section>

    <!-- INÍCIO DO MÊS -->
    <section id="tab-inicio" class="tab-panel inputs">
      <h2 class="panel-title">Início do mês</h2>
      <p class="muted">Defina VR (Caju), entrada inicial do mês e crédito global.</p>

      <div class="monthly-config">
        <div class="month-totals">
          <div class="tot-block">
            <label>VR total (Caju)</label>
            <input id="inicio-vr-total" type="number" step="0.01" />
          </div>
          <div class="tot-block">
            <label>Entrada inicial</label>
            <input id="inicio-entrada-total" type="number" step="0.01" />
          </div>
          <div class="tot-block">
            <label>Crédito global</label>
            <input id="inicio-credit-global" type="number" step="0.01" />
          </div>
        </div>

        <h3 class="panel-subtitle">Créditos por conta</h3>
        <div id="inicio-credits" class="editable-accounts"></div>

        <div class="actions actions-right">
          <button id="apply-start-month" class="btn">Aplicar (Virada do cartão)</button>
          <button id="apply-start-salary" class="btn">Aplicar entrada (salário)</button>
          <button id="clear-start-month" class="btn ghost">Limpar</button>
        </div>
      </div>
    </section>

    <!-- INVESTIMENTOS -->
    <section id="tab-invest" class="tab-panel panel">
      <h2 class="panel-title">Investimentos / guardado</h2>

      <div class="invest-actions">
        <form id="box-form" class="invest-form">
          <div class="form-row">
            <label>Nome da caixinha</label>
            <input id="box-name" type="text" placeholder="Ex: Reserva, Viagem, Emergência"/>
          </div>
          <div class="form-row">
            <label>Conta</label>
            <select id="box-account"></select>
          </div>
          <div class="form-row">
            <label>Legenda</label>
            <input id="box-desc" type="text" placeholder="Detalhe opcional da caixinha"/>
          </div>
          <div class="form-row form-row-button">
            <button id="box-create" class="btn-primary" type="button">Criar caixinha</button>
          </div>
        </form>
      </div>

      <div class="invest-grid">
        <div class="panel-card">
          <h3 class="card-title">Caixinhas de investimento</h3>
          <div id="invest-boxes" class="box-grid"></div>
        </div>

        <div class="panel-card">
          <h3 class="card-title">Resumo por conta</h3>
          <div class="invest-list" id="invest-list"></div>

          <h3 class="card-title" style="margin-top:10px">Total guardado</h3>
          <div class="yellow-grid">
            <div class="y-row">
              <span>Total</span>
              <strong id="guardado-total">R$ 0,00</strong>
            </div>
          </div>

          <h3 class="card-title" style="margin-top:14px">Log de guardado</h3>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Data</th>
                  <th>Conta</th>
                  <th>Ação</th>
                  <th>Valor</th>
                  <th>Descrição</th>
                </tr>
              </thead>
              <tbody id="invest-log-body"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- LOG -->
    <section id="tab-log" class="tab-panel inputs">
      <h2 class="panel-title">Log de lançamentos</h2>

      <div class="backup-controls">
        <button id="backup-export" class="btn">Exportar backup</button>
        <label for="backup-import-input" class="btn ghost">Importar backup</label>
        <input id="backup-import-input" type="file" accept="application/json"/>
      </div>

      <div class="log-controls">
        <div class="log-filter">
          <label>Conta</label>
          <select id="log-account-filter">
            <option value="all">Todas</option>
          </select>
        </div>
        <div class="log-filter">
          <label>Apenas mês ativo</label>
          <input id="log-show-only-month" type="checkbox" checked />
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Data</th>
              <th>Descrição</th>
              <th>Conta</th>
              <th>Tipo</th>
              <th>Categoria</th>
              <th>Valor</th>
              <th>Forma</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="log-body"></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small>Dados salvos no navegador (localStorage).</small>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js"></script>
</body>
</html>
